<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="shortcut icon" type="b-icon" href="logo.jpg">
    <title>ECDoH Festive 2023 Births</title>
    <meta name="viewport" content="width=device-width,
      initial-scale=1.0"/>

    <style>
      *{
    padding: 0;
    margin: 0;
    box-sizing: border-box;
    font-family: sans-serif;
  

}

body{
    display: flex;
    height: 100vh;
    justify-content: center;
    align-items: center;
    background: url(bg-image.jpg);
    background-size: cover;
}

.container{
    width: 100%;
    max-width: 650px;
    background: rgba(0, 0, 0, 0.8);
    padding: 15px;
    margin: 0 28px;
    border-radius: 10px;
    box-shadow: inset -2px 2px 2px white;
}

.form-title{
    font-size: 26px;
    font-weight: 600;
    text-align: center;
    padding-bottom: px;
    color: white;
    text-shadow: 2px 2px 2px black;
    border-bottom: solid 1px white;
}

.main-user-info{
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    padding: 20px 0;
}

/* .user-input-box:nth-child(2n){
    justify-content: end;
} */

.user-input-box {
    display: flex;
    flex-wrap: wrap;
    width: 33%;
    padding-bottom: 15px;
}
.user-input-box[type="number"] {
    display: flex;
    flex-wrap: wrap;
    width: 20%;
    padding-bottom: 15px;
}

.user-input-box-time {
    display: flex;
    flex-wrap: wrap;
    width: 60%;
    padding-bottom: 15px;
}

.user-input-box label{
    width: 95%;
    color: white;
    font-size: 15px;
    font-weight: 300;
    margin: 5px 0;
}
.user-input-box-time label{
    width: 40%;
    color: white;
    font-size: 15px;
    font-weight: 300;
    margin: 5px 0;
}

.user-input-box input,
.user-input-select{
    height: 30px;
    width: 95%;
    border-radius: 7px;
    outline: none;
    border: 1px solid grey;
    padding: 0 10px;
}
.user-input-box input.small-checkbox {
    height: 20px;
    width: 50px;
    border-radius: 3px; /* Adjust as needed */
    outline: none;
    border: 1px solid grey;
    margin-right: 5px; /* Add margin between checkbox and label */
}

.small-checkbox {
    height: 20px;
    width: 20px;
}

.gender-title{
    color:white;
    font-size: 15px;
    font-weight: 300;
    border-bottom: 1px solid white;
}

.gender-category label{
    margin: 15px 0;
    color: white;
}

.gender-category label{
    padding: 0 5px 0 5px;
}

.gender-category label,
.gender-category input,
.form-submit-btn input{
    cursor: pointer;
}

.form-submit-btn{
    margin-top: 40px;
}

.form-submit-btn input{
    display: block;
    width: 100%;
    margin-top: 10px;
    font-size: 20px;
    font-weight: bolder;
    padding: 10px;
    border:none;
    border-radius: 3px;
    color: rgb(209, 209, 209);
    background: rgba(63, 114, 76, 0.7);
}

.form-submit-btn input:hover{
    background: rgba(56, 204, 93, 0.603);
    color: rgb(255, 255, 255);
}

h4 {
  font-size: 16px;
  color: #DFFF00;
  margin-top: 20px; /* Adjust the top margin to create space */
  text-align: center; /* Center the text horizontally */
  line-height: 1.5; /* Adjust the line height for vertical centering */
    }

    a {
      text-decoration: none;
    }

    p {
      padding: 15px 20px;
      font-size: 16px;
      color: #fff;
      border: none;
      cursor: pointer;
      margin: 0; /* Remove default margin */
    }



@media(max-width: 600px){
    .container{
        min-width: 280px;
    }

    .user-input-box,
    .user-input-select{
        margin-bottom: 12px;
        width: 100%;
    }

    .small-checkbox {
        height: 10px;
        width: 10px;
    }
    

    .user-input-box:nth-child(2n){
        justify-content: space-between;
    }

    .gender-category{
        display: flex;
        justify-content: space-between;
        width: 100%;
    }

    .main-user-info{
        max-height: 380px;
        overflow: auto;
    }

    .main-user-info::-webkit-scrollbar{
        width: 0;
    }
}

    </style>
   
  </head>
  <body>
    <div class="container">
     <form id="form" method="POST" onsubmit="addTimestamp()">

     <h1 class="form-title">Festive 2023 - Births</h1>
     
        <div class="main-user-info">
          <div class="user-input-box">
            <!-- <label for="district">District</label> -->
            <select id="district" name="District" class="user-input-select" onchange="populateMunicipality()" required disabled>
              <option value="#" selected disabled>--Select District--</option>
              <option value="Alfred Nzo DM">Alfred Nzo DM</option>
              <option value="Amathole DM">Amathole DM</option>
              <option value="Buffalo City MM">Buffalo City MM</option>
              <option value="Chris Hani DM">Chris Hani DM</option>
              <option value="Joe Qabi DM">Joe Qabi DM</option>
              <option value="Nelson Mandela MM">Nelson Mandela MM</option>
              <option value="OR Tambo DM">OR Tambo DM</option>
              <option value="Sarah Baartman DM">Sarah Baartman DM</option>
            </select>
          </div>
          <div class="user-input-box">
            <!-- <label for="district">District</label> -->
          <select id="municipality" name="LocalMunicipality" class="user-input-select" onchange="populateFacility()" required disabled>
              <option value="#" selected disabled>--Select Local Municipality--</option>
            </select>
          </div>
          <div class="user-input-box">
            <!-- <label for="district">District</label> -->
            <select id="facility" name="Facility" class="user-input-select" required disabled>
              <option value="#" selected disabled>--Select Facility--</option>
            </select>
          </div>

          <div class="user-input-box">
            <!-- <label for="FacilityType">FacilityType</label> -->
            <select id="factype" name="FacilityType" class="user-input-select" required disabled>
              <option value="#" selected disabled>--Select Facility Type--</option>
                <option value="Accute Hospital">Acute </option>
                <option value="Clinic">Clinic</option>
                <option value="Community Day Centre">Community Day Centre</option>
                <option value="Community Health Centre">Community Health Centre</option>
                <option value="Day Hospital">Day Hospital</option>
                <option value="District Hospital">District Hospital</option>
                <option value="Private Hospital">Hospital (Private only)</option>
                <option value="Regional Hospital">Regional Hospital</option>
                <option value="Tertiary Hospital">Provincial Tertiary Hospital</option>
                <option value="Academic Hospital">Academic Hospital</option>
            </select>
        </div>

          <div class="user-input-box">
            <!-- <label for="ReportDate">Report Date</label> -->
            <select id="repdate" name="ReportDate" class="user-input-select" required disabled>
              <option value="#" selected disabled>--Select Report Date--</option>
              <option value="25 December 2023" disabled>25 December 2023</option>
              <option value="01 January 2024">01 January 2024</option>
            </select>
          </div>

          <div class="user-input-box">
            <!-- <label for="TimeSlot">Time Slot</label> -->
            <select id="timeslot" name="TimeSlot" class="user-input-select" required disabled>
              <option value="#" selected disabled>--Select Time Slot--</option>
                <option value="1. 00:01 - 06:00">00:01 - 06:00</option>
                <option value="2. 06:01 - 12:00">06:01 - 12:00</option>
                <option value="3. 12:01 - 18:00">12:01 - 18:00</option>
                <option value="4. 18:01 - 24:00">18:01 - 24:00</option>
            </select>
          </div>

          <div class="user-input-box" style="margin-bottom: 10px;" disabled>
            <div style="display: flex; align-items: center;">
                <input type="checkbox"
                       id="nilbirths"
                       name="NoBirthsToReport"
                       value="Zero Births"
                       class="small-checkbox"/>
                <label for="NoBirthsToReport">No Births To Report</label>
            </div>
          </div>
        <div class="user-input-box" disabled>
            <div style="display: flex; align-items: center;">
                <input type="checkbox"
                       id="bba"
                       name="BornBeforeArrival"
                       value="BBA"
                       class="small-checkbox"/>
                <label for="BornBeforeArrival">Born Before Arrival</label>
            </div>        
            </div>
        <div class="user-input-box">
          <!-- <label for="username">Local Municipality</label> -->
          <input type="text"
                  id="mother"
                  name="MotherName"
                  placeholder="Mother Name"/>
        </div>
        <div class="user-input-box">
          <!-- <label for="username">Local Municipality</label> -->
          <input type="number"
                  id="age"
                  name="MotherAge"
                  placeholder="Mother Age"/>
        </div>
                  <div class="user-input-box">
                    <!-- <label for="FacilityType">FacilityType</label> -->
                    <select id="birthmode" name="BirthMode" class="user-input-select">
                      <option value="#" selected disabled>--Select Birth Mode--</option>
                      <option value="Normal Vertex">Normal Vertex</option>
                      <option value="Caesarean section Elective">Caesarean section Elective</option>
                      <option value="Caesarean section Emergency">Caesarean section Emergency</option>
                      <option value="Vacuum">Vacuum</option>
                      <option value="Forceps">Forceps</option>
                      <option value="Vaginal Breech">Vaginal Breech</option>
                    </select>
        </div>
      <div class="user-input-box">
        <!-- <label for="Gravidity">Local Municipality</label> -->
        <input type="number"
                id="gravidity"
                name="Gravidity"
                placeholder="Gravidity"/>
      </div>
      <div class="user-input-box">
        <!-- <label for="Parity">Local Municipality</label> -->
        <input type="number"
                id="parity"
                name="Parity"
                placeholder="Parity"/>
      </div>
      <div class="user-input-box-time">
                <label for="DeliveryTime">Time of Delivery</label>
                <input type="time"
                id="time"
                name="DeliveryTime"/>
      </div>
      <div class="user-input-box">
        <!-- <label for="FacilityType">FacilityType</label> -->
        <select id="gender" name="Gender" class="user-input-select">
          <option value="#" selected disabled>--Gender--</option>
          <option value=""></option>
          <option value="Female">Female</option>
          <option value="Male">Male</option>
        </select>
      </div>

      <div class="user-input-box">
                <!-- <label for="weigh11">Weight Baby1</label> -->
                <input type="number"
                id="weight"
                name="Weight"
                placeholder="Baby Weight in grams"/>    
      </div>
    <div class="user-input-box">
               <!-- <label for="FacilityType">FacilityType</label> -->
                <select id="multiple" name="Multiple" class="user-input-select">
                  <option value="#" selected disabled>--Select Multiple Birth Baby--</option>
                  <option value=""></option>
                  <option value="Baby 1">Baby 1</option>
                  <option value="Baby 2">Baby 2</option>
                  <option value="Baby 3">Baby 3</option>
                  <option value="Baby 4">Baby 4</option>
                </select>
                
          </div>
          <input type="hidden" id="timestamp" name="Timestamp">
          <div>

      <h4>(Please complete a new form for each <strong>Live Birth if Multiple births)</strong></h4>
       </div>
    </div>  

      <div class="form-submit-btn">
        <input class="button" type="submit" Value="Submit Birth" id="submit-button">
      </div>
</form>
       
      <div
      id="message"
      style="
        display: none;
        margin: 20px;
        font-weight: bold;
        color: green;
        padding: 8px;
        background-color: beige;
        border-radius: 4px;
        border-color: aquamarine;
      "></div>
    <script>
        var municipalities = {
          "Alfred Nzo DM": ["Matatiele LM", "Umzimvubu LM", "Mbizana LM", "Ntabankulu LM"],
          "Amathole DM":[ "Mbhashe LM", "Raymond Mhlaba LM", "Amahlathi LM", "Mnquma LM", "Great Kei LM", "Ngqushwa LM"],
          "Buffalo City MM":['Buffalo City SD'],
          "Chris Hani DM":["Emalahleni LM", "Inxuba Yethemba LM", "Enoch Mgijima LM", "Engcobo LM", "Sakhisizwe LM", "Intsika Yethu LM"],
          "Joe Qabi DM":["Walter Sisulu LM", "Elundini LM", "Senqu LM"],
          "Nelson Mandela MM":["N Mandela B SD","N Mandela C SD","N Mandela A SD"],
          "OR Tambo DM":["Nyandeni LM","Ingquza Hill LM","Mhlontlo LM","King Sabata Dalindyebo LM","Port St Johns LM"],
          "Sarah Baartman DM":[ "Makana LM", "Blue Crane Route LM","Ndlambe LM","Dr B Naudé LM", "Sundays River Valley LM", "Kou-Kamma LM","Kouga LM"]
        };


        var facilities = {
          
          "Matatiele LM":["Maluti CHC","Tayler Bequest Hospital (Matatiele)"],	
          "Mbizana LM":["Greenville Hospital", "St Patrick's Hospital"],	
          "Ntabankulu LM":["Sipetu Hospital","Tabankulu CHC"],	
          "Umzimvubu LM":["Madzikane Ka Zulu Memorial Hospital","Mount Ayliff Hospital"],	
          "Amahlathi LM":["Cathcart Hospital","SS Gida Hospital","Stutterheim Hospital"],	
          "Great Kei LM":["Komga Hospital"],	
          "Mbhashe LM":["Idutywa Village CHC", "Madwaleni Hospital", "Willowvale CHC","Xhora CHC"],	
          "Mnquma LM":["Butterworth Hospital","Nqamakwe CHC","Tafalofefe Hospital"],
          "Ngqushwa LM":["Nompumelelo (Peddie) Hospital"],
          "Raymond Mhlaba LM":["Adelaide Hospital", "Bedford Hospital", "Fort Beaufort Hospital","Middledrift CHC","Victoria Hospital"],	
          "Buffalo City SD":["Bhisho Hospital","Cecilia Makiwane Hospital","Dimbaza CHC","Duncan Village CHC","Empilweni Gompo CHC","Frere Hospital","Nontyatyambo CHC"],
          "Emalahleni LM":["Dordrecht Hospital",	"Glen Grey Hospital","Indwe Hospital","Ngonyama CHC"],
          "Engcobo LM":["All Saints Hospital","Mjanyana Hospital","Ngcobo CHC",	"Zwelakhe Dalasile CHC"
          ],
          "Enoch Mgijima LM":["Care Cure Queenstown Hospital","Frontier Hospital","Hewu Hospital","Life Queenstown Prv Hosp","Martje Venter (Tarkastad) Hospital","Molteno Hospital","Nomzamo CHC","Sterkstroom Hospital","Thornhill CHC","Whittlesea CHC"],	
          "Intsika Yethu LM":["Cofimvaba Hospital","Kuyasa CHC"],	
          "Inxuba Yethemba LM":["Cradock Hospital","Wilhelm Stahl (Middelburg) Hospital"],	
          "Sakhisizwe LM":["Cala Hospital","Elliot Hospital"],	
          "Elundini LM":["Maclear Hospital","Taylor Bequest Hospital (Elundini)"],	
          "Senqu LM":["Cloete Joubert (Barkly East) Hospital","Empilisweni Hospital","Lady Grey Hospital","Umlamli Hospital"],	
          "Walter Sisulu LM":["Aliwal North Hospital","Burgersdorp Hospital","Jamestown Hospital","St Francis Hospital","Steynsburg Hospital"],	
          "N Mandela A SD":["Dora Nginza Hospital","Kwazakhele CHC","Motherwell CHC"],	
          "N Mandela B SD":["Laetitia Bam CHC","Netcare Cuyler Hosp","Rosedale CHC","Uitenhage Hospital"],	
          "N Mandela C SD":["Central CHC (Sandford)","Gqebera CHC","Korsten CHC","Life Mercantile Hospital","Life St George's Hosp","Livingstone Hospital",	"Netcare Greenacres Hosp","New Brighton CHC","Port Elizabeth Provincial Hospital","West End CHC","Westways Hosp"],
            
          "Ingquza Hill LM":["Flagstaff CHC","Holy Cross Hospital","St Elizabeth's Hospital","Lusikisiki Village Clinic"],	
          "King Sabata Dalindyebo LM":["Baziya CHC","Canzibe Hospital","Crossmed Mthatha Private Hospital","Life St Mary's Hosp","Mbekweni CHC","Mqanduli CHC","Mthatha General Hospital","Nelson Mandela Academic Hospital","Ngangelizwe CHC","Ngcwanguba CHC","Zithulele Hospital"],	
          "Mhlontlo LM":["Dr Malizo Mpehle Memorial Hospital",	"Isilimela Hospital","Mhlakulo CHC","Nessie Knight Hospital","Qumbu CHC",	"St Lucy's Hospital"],	
          "Nyandeni LM":["Canzibe Hospital","Makhotyana CHC","St Barnabas Hospital"],	
          "Port St Johns LM":["Bambisana Hospital","Isilimela Hospital","Port St Johns CHC","Tombo CHC"],	
          "Blue Crane Route LM":["Andries Vosloo Hospital"],	
          "Dr B Naudé LM":["Aberdeen Hospital",	"Graaff-Reinet Day Hospital","Midland Hospital","SAWAS Memorial (Jansenville) Hospital","Willowmore Hospital"],	
          "Kouga LM":["Humansdorp Hospital","Life Isivivana Hosp"],	
          "Kou-Kamma LM":["BJ Vorster (Kareedouw) Hospital","Joubertina CHC"],	
          "Makana LM":["Settlers Day Hospital CHC","Settlers Hospital"],	
          "Ndlambe LM":["Port Alfred Hospital"],	
          "Sundays River Valley LM":["Sundays Valley (Kirkwood) Hospital"]


	
};

var districtSelect = document.getElementById("district");
var municipalitySelect = document.getElementById("municipality");
var facilitySelect = document.getElementById("facility");

function populateMunicipality() {
  municipalitySelect.innerHTML = '<option value="#" selected disabled>--Select Local Municipality--</option>';
  facilitySelect.innerHTML = '<option value="#" selected disabled>--Select Facility--</option>';

  var selectedDistrict = districtSelect.value;
  if (selectedDistrict) {
    var selectedDistrictMunicipalities = municipalities[selectedDistrict];
    selectedDistrictMunicipalities.forEach(function (municipality) {
      var option = document.createElement("option");
      option.value = municipality;
      option.text = municipality;
      municipalitySelect.appendChild(option);
    });
  }
}

function populateFacility() {
  facilitySelect.innerHTML = '<option value="#" selected disabled>--Select Facility--</option>';
  var selectedMunicipality = municipalitySelect.value;
  if (selectedMunicipality) {
    var selectedMunicipalityFacilities = facilities[selectedMunicipality];
    selectedMunicipalityFacilities.forEach(function (facility) {
      var option = document.createElement("option");
      option.value = facility;
      option.text = facility;
      facilitySelect.appendChild(option);
    });
  }
}

</script>

<script>
  function addTimestamp() {
      // Get the current date and time
      const now = new Date();

      // Format the date and time as a string
      const timestamp = `${now.getFullYear()}-${(now.getMonth() + 1).toString().padStart(2, '0')}-${now.getDate().toString().padStart(2, '0')} ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;

      // Set the value of the hidden input field
      document.getElementById('timestamp').value = timestamp;

      // You can also log the timestamp to the console for verification
      console.log('Timestamp:', timestamp);

      // The form will be submitted as usual
  }
</script>


<script>
  // Function to disable/enable specific fields based on the nilbirths checkbox state
  function disableFields() {
      var nilBirthsCheckbox = document.getElementById('nilbirths');
      var bbaField = document.getElementById('bba');
      var motherField = document.getElementById('mother');
      var ageField = document.getElementById('age');
      var birthmodeField = document.getElementById('birthmode');
      var gravidityField = document.getElementById('gravidity');
      var parityField = document.getElementById('parity');
      var timeField = document.getElementById('time');
      var genderField = document.getElementById('gender');
      var weightField = document.getElementById('weight');
      var multipleField = document.getElementById('multiple');

      // Check if the nilbirths checkbox is checked
      if (nilBirthsCheckbox.checked) {
          // Disable the fields
          bbaField.disabled = true;
          motherField.disabled = true;
          ageField.disabled = true;
          birthmodeField.disabled = true;
          gravidityField.disabled = true;
          parityField.disabled = true;
          timeField.disabled = true;
          genderField.disabled = true;
          weightField.disabled = true;
          multipleField.disabled = true;
      } else {
          // Enable the fields
          bbaField.disabled = false;
          motherField.disabled = false;
          ageField.disabled = false;
          birthmodeField.disabled = false;
          gravidityField.disabled = false;
          parityField.disabled = false;
          timeField.disabled = false;
          genderField.disabled = false;
          weightField.disabled = false;
          multipleField.disabled = false;
      }
  }

  // Attach the function to the change event of the nilbirths checkbox
  document.getElementById('nilbirths').addEventListener('change', disableFields);

  // Form submission logic
  document.getElementById("form").addEventListener("submit", function (e) {
      e.preventDefault(); // Prevent the default form submission

      // Check if required fields are filled
      if (!validateForm()) {
          return;
      }

      document.getElementById("message").textContent = "Submitting..";
      document.getElementById("message").style.display = "block";
      document.getElementById("submit-button").disabled = true;

      // Collect the form data
      var formData = new FormData(this);
      var keyValuePairs = [];
      for (var pair of formData.entries()) {
          keyValuePairs.push(pair[0] + "=" + pair[1]);
      }

      var formDataString = keyValuePairs.join("&");

      // Send a POST request to your Google Apps Script
      fetch(
          "https://script.google.com/macros/s/1AKfycbx_6yQMq0xQ1F5dlM39DrVz3CO-P_lUR-2zAAOmritTsBZze3UW_blINagXQ_EYkbTIIA/exec",
          {
              redirect: "follow",
              method: "POST",
              body: formDataString,
              headers: {
                  "Content-Type": "text/plain;charset=utf-8",
              },
          }
      )
          .then(function (response) {
              // Check if the request was successful
              if (response) {
                  return response; // Assuming your script returns JSON response
              } else {
                  throw new Error("Failed to submit the form.");
              }
          })
          .then(function (data) {
              // Display a success message
              document.getElementById("message").textContent =
                  "Data submitted successfully!";
              document.getElementById("message").style.display = "block";
              document.getElementById("message").style.backgroundColor = "green";
              document.getElementById("message").style.color = "beige";

              // Reset the form
              window.location.reload();

              // Enable all fields
              disableFields();

              setTimeout(function () {
                  document.getElementById("message").textContent = "";
                  document.getElementById("message").style.display = "none";
              }, 2600);
          })
          .catch(function (error) {
              // Handle errors, you can display an error message here
              console.error(error);
              document.getElementById("message").textContent =
                  "An error occurred while submitting the form.";
              document.getElementById("message").style.display = "block";
          });
  });
</script>

<script>

function validateForm() {
    // Perform your custom validation here
    // For example, check if required fields are not empty
    var district = document.getElementById("district").value;
    var municipality = document.getElementById("municipality").value;
    var facility = document.getElementById("facility").value;
    var factype = document.getElementById("factype").value;
    var repdate = document.getElementById("repdate").value;
    var timeslot = document.getElementById("timeslot").value;

    if (district === "#") {
        alert("Please select a District.");
        return false;
    }

    if (municipality === "#") {
        alert("Please select a Local Municipality.");
        return false;
    }

    if (facility === "#") {
        alert("Please select a Facility.");
        return false;
    }

    if (factype === "#") {
        alert("Please select a Facility Type.");
        return false;
    }

    if (repdate === "#") {
        alert("Please select a Report Date.");
        return false;
    }

    if (timeslot === "#") {
        alert("Please select a Time Slot.");
        return false;
    }

    return true;
}

    </script>

<span>
<a href="https://lookerstudio.google.com/reporting/d5077e1b-eba4-48a3-9617-d460f5b4aae6" target="_blank">
  <p>
      Click here to Access the Festive 2023 Birth Dashboard
  </p>
</a>
</span>
  </body>
</html>
